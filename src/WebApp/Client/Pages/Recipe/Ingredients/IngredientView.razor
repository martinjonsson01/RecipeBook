@using RecipeBook.Core.Domain.Recipes

@inherits SyncedView<Ingredient>

@inject IJSRuntime _js;

<textarea @ref="_input" class="remove-input-style step" type="text" @bind="Name" @bind:event="oninput"></textarea>

@code {
#nullable enable

    [Parameter]
    public Ingredient Ingredient { get; set; } = null!;

    private ElementReference _input;

    private string Name
    {
        get => Ingredient.Name;
        set
        {
            _js.InvokeVoidAsync("interopFunctions.textareaAutoHeight", _input);
            Ingredient.Name = value;
            ResourceHasChanged();
        }
    }

    protected override void OnInitialized()
    {
        Initialize(Ingredient);
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        await _js.InvokeVoidAsync("interopFunctions.textareaAutoHeight", _input);
        await _js.InvokeVoidAsync("interopFunctions.copyElementHeight", $"ingredient-{Ingredient.Id}", $"unit-{Ingredient.Id}");
    }

}